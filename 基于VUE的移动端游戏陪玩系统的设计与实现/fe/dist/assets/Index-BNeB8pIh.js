import{T as G}from"./TabBar-CMAjETSw.js";import{r as y}from"./request-giXr0CrS.js";import{I as w}from"./iconify-BGqMIu7N.js";import{c as o,a as s,b as i,d as I,u as k,o as n,_ as S,e as V,r as v,F as d,f as m,n as A,t as h}from"./index-BOjwxA-V.js";import{_ as B,D as N,a as q,b as E,G as T}from"./images-DA-C5pRA.js";const U={class:"w-full"},D={class:"flex items-center bg-white/10 rounded-full px-4 py-2 border border-white/10 backdrop-blur-sm focus-within:ring-2 ring-primary/40"},K=["placeholder","value"],j={__name:"SearchBar",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"ÊêúÁ¥¢Èô™Áé©Â∏à/Ê∏∏Êàè"}},emits:["update:modelValue","submit"],setup(a,{emit:e}){const c=e;function g(p){c("update:modelValue",p.target.value)}function l(){c("update:modelValue","")}function r(){c("submit")}return(p,u)=>(n(),o("div",U,[s("div",D,[i(k(w),{icon:"mdi:magnify",class:"text-gray-400 mr-2",width:"20",height:"20"}),s("input",{placeholder:a.placeholder,value:a.modelValue,onInput:g,class:"flex-1 bg-transparent text-white text-sm placeholder:text-gray-400 outline-none"},null,40,K),a.modelValue?(n(),o("button",{key:0,class:"ml-2 text-gray-400 active:scale-95",onClick:l},[i(k(w),{icon:"mdi:close",width:"18",height:"18"})])):I("",!0),s("button",{class:"ml-3 btn-primary-sm",onClick:r},"ÊêúÁ¥¢")])]))}},F={name:"Index",components:{TabBar:G,SearchBar:j,SmartImage:B},data(){return{banners:["https://images.unsplash.com/photo-1606112219348-204d7d8b94ee?q=80&w=1200&auto=format&fit=crop","https://images.unsplash.com/photo-1511512578047-dfb367046420?q=80&w=1200&auto=format&fit=crop","https://images.unsplash.com/photo-1517466787929-48cae717c81a?q=80&w=1200&auto=format&fit=crop"],games:[],companions:[],loadingGames:!1,loadingCompanions:!1,errorGames:!1,errorCompanions:!1,searchKey:"",selectedGameId:null,GAME_ICON_MAP:T,fallbacks:{avatar:E,game:q,banner:N}}},mounted(){this.fetchGames(),this.fetchCompanions()},methods:{async fetchGames(){try{this.loadingGames=!0,this.errorGames=!1;const a=this.searchKey?`?keyword=${encodeURIComponent(this.searchKey)}`:"",e=await y({url:`/games/list${a}`});this.games=e.data}catch(a){console.error(a),this.errorGames=!0}finally{this.loadingGames=!1}},async fetchCompanions(){try{this.loadingCompanions=!0,this.errorCompanions=!1;const a=new URLSearchParams;this.searchKey&&a.set("keyword",this.searchKey),this.selectedGameId&&a.set("game_id",this.selectedGameId);const e=a.toString()?`?${a.toString()}`:"",c=await y({url:`/companions/list${e}`});this.companions=c.data}catch(a){console.error(a),this.errorCompanions=!0}finally{this.loadingCompanions=!1}},goDetail(a){this.$router.push(`/companion/${a.id}`)},onSearch(){this.fetchGames(),this.fetchCompanions()},selectGame(a){this.selectedGameId=this.selectedGameId===a.id?null:a.id,this.fetchCompanions()}}},L={class:"min-h-screen bg-gradient-to-b from-secondary via-dark to-black pb-24 overflow-x-hidden w-full"},M={class:"px-4 pt-6"},R={class:"mt-4"},O={class:"px-4 mt-4"},P={class:"flex gap-4 overflow-x-auto no-scrollbar snap-x snap-mandatory"},z={class:"mt-6"},H={key:0,class:"px-4"},J={class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4"},Q={key:1,class:"px-4"},W={class:"card p-6 text-center"},X={key:2,class:"px-4"},Y={key:3,class:"px-4"},Z={class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4"},$=["onClick"],ss={class:"text-gray-300 text-xs mt-1 w-full truncate text-center"},es={class:"mt-8 px-4"},ts={key:0,class:"grid grid-cols-2 gap-4 px-0 animate-pulse"},as={key:1,class:"px-4"},os={class:"card p-6 text-center"},ns={key:2,class:"px-4"},ls={key:3,class:"grid grid-cols-2 gap-4"},rs=["onClick"],is={class:"relative aspect-[3/4]"},cs={class:"absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/80 to-transparent p-3"},ds={class:"flex items-center"},ms={class:"text-white font-bold text-sm"},ps={class:"p-3"},us={class:"flex items-center justify-between mb-2"},fs={class:"text-primary font-bold text-sm"},hs={class:"flex flex-wrap gap-1 items-center"},vs={class:"chip"};function gs(a,e,c,g,l,r){const p=v("SearchBar"),u=v("SmartImage"),C=v("TabBar");return n(),o("div",L,[s("div",M,[e[3]||(e[3]=V('<div class="flex items-center justify-between" data-v-a7ffc037><div class="flex items-center gap-3" data-v-a7ffc037><div class="h-10 w-10 rounded-xl bg-gradient-to-tr from-primary to-pink-500 grid place-items-center animate-[pulse-glow_3s_ease_infinite]" data-v-a7ffc037>üéÆ</div><div class="hero-title" data-v-a7ffc037>ÁîµÁ´ûÈô™Áé©</div></div><div class="hidden md:flex items-center gap-3" data-v-a7ffc037><button class="btn-secondary-sm" data-v-a7ffc037>ÂèëÁé∞</button><button class="btn-primary-sm" data-v-a7ffc037>ÂèëÂ∏É</button></div></div>',1)),s("div",R,[i(p,{modelValue:l.searchKey,"onUpdate:modelValue":e[0]||(e[0]=t=>l.searchKey=t),onSubmit:r.onSearch},null,8,["modelValue","onSubmit"])])]),s("div",O,[s("div",P,[(n(!0),o(d,null,m(l.banners,(t,f)=>(n(),o("div",{class:"h-48 w-[85%] min-w-[280px] shrink-0 snap-center rounded-3xl overflow-hidden shadow-2xl",key:f},[i(u,{src:t,fallback:l.fallbacks.banner,cls:"w-full h-full object-cover"},null,8,["src","fallback"])]))),128))])]),s("div",z,[e[7]||(e[7]=s("div",{class:"px-4 mb-3 flex justify-between items-end"},[s("span",{class:"section-title"},"ÁÉ≠Èó®Ê∏∏Êàè"),s("span",{class:"chip-info flex items-center"},"Êü•ÁúãÂÖ®ÈÉ®")],-1)),l.loadingGames?(n(),o("div",H,[s("div",J,[(n(),o(d,null,m(4,t=>s("div",{key:t,class:"flex flex-col items-center animate-pulse"},[...e[4]||(e[4]=[s("div",{class:"w-full aspect-square rounded-2xl bg-white/5 border border-white/10 mb-2"},null,-1),s("div",{class:"w-12 h-2 bg-white/10 rounded"},null,-1)])])),64))])])):l.errorGames?(n(),o("div",Q,[s("div",W,[e[5]||(e[5]=s("span",{class:"text-gray-500 mb-3"},"Âä†ËΩΩÂ§±Ë¥•",-1)),s("button",{class:"btn-secondary-sm",onClick:e[1]||(e[1]=(...t)=>r.fetchGames&&r.fetchGames(...t))},"ÈáçËØï")])])):l.games.length===0?(n(),o("div",X,[...e[6]||(e[6]=[s("div",{class:"card p-6 text-center text-gray-400"},"ÊöÇÊó†Ê∏∏Êàè",-1)])])):(n(),o("div",Y,[s("div",Z,[(n(!0),o(d,null,m(l.games,t=>(n(),o("div",{key:t.id||t.name,class:"flex flex-col items-center group cursor-pointer min-w-0",onClick:f=>r.selectGame(t)},[s("div",{class:A(["w-full aspect-square rounded-2xl bg-light border border-white/10 p-1 mb-2 relative overflow-hidden transition-all",l.selectedGameId===t.id?"ring-2 ring-primary/70":"group-hover:ring-2 ring-primary/50"])},[i(u,{src:t.icon,fallback:l.GAME_ICON_MAP[t.name]||l.fallbacks.game,cls:"w-full h-full rounded-xl group-hover:scale-105 transition-transform object-cover"},null,8,["src","fallback"])],2),s("span",ss,h(t.name),1)],8,$))),128))])]))]),s("div",es,[e[14]||(e[14]=s("div",{class:"mb-4"},[s("span",{class:"section-title"},"Êé®ËçêÈô™Áé©")],-1)),l.loadingCompanions?(n(),o("div",ts,[(n(),o(d,null,m(4,t=>s("div",{key:t,class:"card overflow-hidden"},[...e[8]||(e[8]=[s("div",{class:"relative aspect-[3/4] bg-white/5"},null,-1),s("div",{class:"p-3"},[s("div",{class:"h-4 w-24 bg-white/10 rounded mb-2"}),s("div",{class:"h-3 w-16 bg-white/10 rounded"})],-1)])])),64))])):l.errorCompanions?(n(),o("div",as,[s("div",os,[e[9]||(e[9]=s("span",{class:"text-gray-500 mb-3"},"Âä†ËΩΩÂ§±Ë¥•",-1)),s("button",{class:"btn-secondary-sm",onClick:e[2]||(e[2]=(...t)=>r.fetchCompanions&&r.fetchCompanions(...t))},"ÈáçËØï")])])):l.companions.length===0?(n(),o("div",ns,[...e[10]||(e[10]=[s("div",{class:"card p-6 text-center"},[s("span",{class:"text-gray-500"},"ÊöÇÊó†Êé®ËçêÂÜÖÂÆπ")],-1)])])):(n(),o("div",ls,[(n(!0),o(d,null,m(l.companions,(t,f)=>{var b,_,x;return n(),o("div",{key:f,class:"card overflow-hidden transition-all hover:translate-y-[-2px] hover:shadow-2xl",onClick:bs=>r.goDetail(t)},[s("div",is,[i(u,{src:(b=t.User)==null?void 0:b.avatar,fallback:l.fallbacks.avatar,cls:"w-full h-full object-cover"},null,8,["src","fallback"]),s("div",cs,[s("div",ds,[s("span",ms,h(((_=t.User)==null?void 0:_.nickname)||"Êú™Áü•Áî®Êà∑"),1),e[11]||(e[11]=s("span",{class:"badge-primary ml-2"},"20",-1))])])]),s("div",ps,[s("div",us,[s("span",fs,"¬•"+h(t.price)+"/Â±Ä",1),e[12]||(e[12]=s("span",{class:"text-gray-500 text-xs"},"0.5km",-1))]),s("div",hs,[s("span",vs,h(((x=t.Game)==null?void 0:x.name)||"Êú™Áü•Ê∏∏Êàè"),1),e[13]||(e[13]=s("span",{class:"chip-primary"},"ÁÉ≠Èó®",-1))])])],8,rs)}),128))]))]),i(C)])}const Cs=S(F,[["render",gs],["__scopeId","data-v-a7ffc037"]]);export{Cs as default};
